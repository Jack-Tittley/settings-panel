/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/apexcharts@3.45.2/src/charts/Bar.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import BarDataLabels from"./common/bar/DataLabels";import BarHelpers from"./common/bar/Helpers";import CoreUtils from"../modules/CoreUtils";import Utils from"../utils/Utils";import Filters from"../modules/Filters";import Graphics from"../modules/Graphics";import Series from"../modules/Series";class Bar{constructor(e,s){this.ctx=e,this.w=e.w;const i=this.w;this.barOptions=i.config.plotOptions.bar,this.isHorizontal=this.barOptions.horizontal,this.strokeWidth=i.config.stroke.width,this.isNullValue=!1,this.isRangeBar=i.globals.seriesRange.length&&this.isHorizontal,this.isVerticalGroupedRangeBar=!i.globals.isBarHorizontal&&i.globals.seriesRange.length&&i.config.plotOptions.bar.rangeBarGroupRows,this.isFunnel=this.barOptions.isFunnel,this.xyRatios=s,null!==this.xyRatios&&(this.xRatio=s.xRatio,this.yRatio=s.yRatio,this.invertedXRatio=s.invertedXRatio,this.invertedYRatio=s.invertedYRatio,this.baseLineY=s.baseLineY,this.baseLineInvertedY=s.baseLineInvertedY),this.yaxisIndex=0,this.seriesLen=0,this.pathArr=[];const t=new Series(this.ctx);this.lastActiveBarSerieIndex=t.getActiveConfigSeriesIndex("desc",["bar","column"]);const a=t.getBarSeriesIndices(),r=new CoreUtils(this.ctx);this.stackedSeriesTotals=r.getStackedSeriesTotals(this.w.config.series.map(((e,s)=>-1===a.indexOf(s)?s:-1)).filter((e=>-1!==e))),this.barHelpers=new BarHelpers(this)}draw(e,s){let i=this.w,t=new Graphics(this.ctx);const a=new CoreUtils(this.ctx,i);e=a.getLogSeries(e),this.series=e,this.yRatio=a.getLogYRatios(this.yRatio),this.barHelpers.initVariables(e);let r=t.group({class:"apexcharts-bar-series apexcharts-plot-series"});i.config.dataLabels.enabled&&this.totalItems>this.barOptions.dataLabels.maxItems&&console.warn("WARNING: DataLabels are enabled but there are too many to display. This may cause performance issue when rendering - ApexCharts");for(let a=0,o=0;a<e.length;a++,o++){let l,n,h,d,b,p,g=[],c=[],x=i.globals.comboCharts?s[a]:a,u=t.group({class:"apexcharts-series",rel:a+1,seriesName:Utils.escapeString(i.globals.seriesNames[x]),"data:realIndex":x});this.ctx.series.addCollapsedClassToSeries(u,x),e[a].length>0&&(this.visibleI=this.visibleI+1);let m=0,y=0;this.yRatio.length>1&&(this.yaxisIndex=x),this.isReversed=i.config.yaxis[this.yaxisIndex]&&i.config.yaxis[this.yaxisIndex].reversed;let f=this.barHelpers.initialPositions();n=f.y,m=f.barHeight,d=f.yDivision,p=f.zeroW,l=f.x,y=f.barWidth,h=f.xDivision,b=f.zeroH,this.horizontal||c.push(l+y/2);let I=t.group({class:"apexcharts-datalabels","data:realIndex":x});i.globals.delayedElements.push({el:I.node}),I.node.classList.add("apexcharts-element-hidden");let v=t.group({class:"apexcharts-bar-goals-markers"}),H=t.group({class:"apexcharts-bar-shadows"});i.globals.delayedElements.push({el:H.node}),H.node.classList.add("apexcharts-element-hidden");for(let s=0;s<i.globals.dataPoints;s++){const t=this.barHelpers.getStrokeWidth(a,s,x);let r=null;const f={indexes:{i:a,j:s,realIndex:x,bc:o},x:l,y:n,strokeWidth:t,elSeries:u};this.isHorizontal?(r=this.drawBarPaths({...f,barHeight:m,zeroW:p,yDivision:d}),y=this.series[a][s]/this.invertedYRatio):(r=this.drawColumnPaths({...f,xDivision:h,barWidth:y,zeroH:b}),m=this.series[a][s]/this.yRatio[this.yaxisIndex]);let w=this.barHelpers.getPathFillColor(e,a,s,x);if(this.isFunnel&&this.barOptions.isFunnel3d&&this.pathArr.length&&s>0){const e=this.barHelpers.drawBarShadow({color:"string"==typeof w&&-1===w?.indexOf("url")?w:Utils.hexToRgba(i.globals.colors[a]),prevPaths:this.pathArr[this.pathArr.length-1],currPaths:r});e&&H.add(e)}this.pathArr.push(r);const P=this.barHelpers.drawGoalLine({barXPosition:r.barXPosition,barYPosition:r.barYPosition,goalX:r.goalX,goalY:r.goalY,barHeight:m,barWidth:y});P&&v.add(P),n=r.y,l=r.x,s>0&&c.push(l+y/2),g.push(n),this.renderSeries({realIndex:x,pathFill:w,j:s,i:a,pathFrom:r.pathFrom,pathTo:r.pathTo,strokeWidth:t,elSeries:u,x:l,y:n,series:e,barHeight:r.barHeight?r.barHeight:m,barWidth:r.barWidth?r.barWidth:y,elDataLabelsWrap:I,elGoalsMarkers:v,elBarShadows:H,visibleSeries:this.visibleI,type:"bar"})}i.globals.seriesXvalues[x]=c,i.globals.seriesYvalues[x]=g,r.add(u)}return r}renderSeries({realIndex:e,pathFill:s,lineFill:i,j:t,i:a,groupIndex:r,pathFrom:o,pathTo:l,strokeWidth:n,elSeries:h,x:d,y:b,y1:p,y2:g,series:c,barHeight:x,barWidth:u,barXPosition:m,barYPosition:y,elDataLabelsWrap:f,elGoalsMarkers:I,elBarShadows:v,visibleSeries:H,type:w}){const P=this.w,W=new Graphics(this.ctx);i||(i=this.barOptions.distributed?P.globals.stroke.colors[t]:P.globals.stroke.colors[e]),P.config.series[a].data[t]&&P.config.series[a].data[t].strokeColor&&(i=P.config.series[a].data[t].strokeColor),this.isNullValue&&(s="none");let S=t/P.config.chart.animations.animateGradually.delay*(P.config.chart.animations.speed/P.globals.dataPoints)/2.4,X=W.renderPaths({i:a,j:t,realIndex:e,pathFrom:o,pathTo:l,stroke:i,strokeWidth:n,strokeLineCap:P.config.stroke.lineCap,fill:s,animationDelay:S,initialSpeed:P.config.chart.animations.speed,dataChangeSpeed:P.config.chart.animations.dynamicAnimation.speed,className:`apexcharts-${w}-area`});X.attr("clip-path",`url(#gridRectMask${P.globals.cuid})`);const k=P.config.forecastDataPoints;k.count>0&&t>=P.globals.dataPoints-k.count&&(X.node.setAttribute("stroke-dasharray",k.dashArray),X.node.setAttribute("stroke-width",k.strokeWidth),X.node.setAttribute("fill-opacity",k.fillOpacity)),void 0!==p&&void 0!==g&&(X.attr("data-range-y1",p),X.attr("data-range-y2",g));new Filters(this.ctx).setSelectionFilter(X,e,t),h.add(X);let L=new BarDataLabels(this).handleBarDataLabels({x:d,y:b,y1:p,y2:g,i:a,j:t,series:c,realIndex:e,groupIndex:r,barHeight:x,barWidth:u,barXPosition:m,barYPosition:y,renderedPath:X,visibleSeries:H});return null!==L.dataLabels&&f.add(L.dataLabels),L.totalDataLabels&&f.add(L.totalDataLabels),h.add(f),I&&h.add(I),v&&h.add(v),h}drawBarPaths({indexes:e,barHeight:s,strokeWidth:i,zeroW:t,x:a,y:r,yDivision:o,elSeries:l}){let n,h=this.w,d=e.i,b=e.j;if(h.globals.isXNumeric)n=(r=(h.globals.seriesX[d][b]-h.globals.minX)/this.invertedXRatio-s)+s*this.visibleI;else if(h.config.plotOptions.bar.hideZeroBarsWhenGrouped){let e=0,i=0;h.globals.seriesPercent.forEach(((s,t)=>{s[b]&&e++,t<d&&0===s[b]&&i++})),e>0&&(s=this.seriesLen*s/e),n=r+s*this.visibleI,n-=s*i}else n=r+s*this.visibleI;this.isFunnel&&(t-=(this.barHelpers.getXForValue(this.series[d][b],t)-t)/2),a=this.barHelpers.getXForValue(this.series[d][b],t);const p=this.barHelpers.getBarpaths({barYPosition:n,barHeight:s,x1:t,x2:a,strokeWidth:i,series:this.series,realIndex:e.realIndex,i:d,j:b,w:h});return h.globals.isXNumeric||(r+=o),this.barHelpers.barBackground({j:b,i:d,y1:n-s*this.visibleI,y2:s*this.seriesLen,elSeries:l}),{pathTo:p.pathTo,pathFrom:p.pathFrom,x1:t,x:a,y:r,goalX:this.barHelpers.getGoalValues("x",t,null,d,b),barYPosition:n,barHeight:s}}drawColumnPaths({indexes:e,x:s,y:i,xDivision:t,barWidth:a,zeroH:r,strokeWidth:o,elSeries:l}){let n,h=this.w,d=e.realIndex,b=e.i,p=e.j,g=e.bc;if(h.globals.isXNumeric){const e=this.getBarXForNumericXAxis({x:s,j:p,realIndex:d,barWidth:a});s=e.x,n=e.barXPosition}else if(h.config.plotOptions.bar.hideZeroBarsWhenGrouped){const{nonZeroColumns:e,zeroEncounters:i}=this.barHelpers.getZeroValueEncounters({i:b,j:p});e>0&&(a=this.seriesLen*a/e),n=s+a*this.visibleI,n-=a*i}else n=s+a*this.visibleI;i=this.barHelpers.getYForValue(this.series[b][p],r);const c=this.barHelpers.getColumnPaths({barXPosition:n,barWidth:a,y1:r,y2:i,strokeWidth:o,series:this.series,realIndex:e.realIndex,i:b,j:p,w:h});return h.globals.isXNumeric||(s+=t),this.barHelpers.barBackground({bc:g,j:p,i:b,x1:n-o/2-a*this.visibleI,x2:a*this.seriesLen+o/2,elSeries:l}),{pathTo:c.pathTo,pathFrom:c.pathFrom,x:s,y:i,goalY:this.barHelpers.getGoalValues("y",null,r,b,p),barXPosition:n,barWidth:a}}getBarXForNumericXAxis({x:e,barWidth:s,realIndex:i,j:t}){const a=this.w;let r=i;return a.globals.seriesX[i].length||(r=a.globals.maxValsInArrayIndex),a.globals.seriesX[r][t]&&(e=(a.globals.seriesX[r][t]-a.globals.minX)/this.xRatio-s*this.seriesLen/2),{barXPosition:e+s*this.visibleI,x:e}}getPreviousPath(e,s){let i,t=this.w;for(let a=0;a<t.globals.previousPaths.length;a++){let r=t.globals.previousPaths[a];r.paths&&r.paths.length>0&&parseInt(r.realIndex,10)===parseInt(e,10)&&void 0!==t.globals.previousPaths[a].paths[s]&&(i=t.globals.previousPaths[a].paths[s].d)}return i}}export default Bar;
//# sourceMappingURL=/sm/a7ae32f9a6ee407ff46ac27461d39b93f8b0969924b8490e3c8b5ea714a6eaa2.map