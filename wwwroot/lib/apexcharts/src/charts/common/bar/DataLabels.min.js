/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/apexcharts@3.45.2/src/charts/common/bar/DataLabels.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Graphics from"../../../modules/Graphics";import DataLabels from"../../../modules/DataLabels";export default class BarDataLabels{constructor(t){this.w=t.w,this.barCtx=t,this.totalFormatter=this.w.config.plotOptions.bar.dataLabels.total.formatter,this.totalFormatter||(this.totalFormatter=this.w.config.dataLabels.formatter)}handleBarDataLabels(t){let{x:a,y:e,y1:s,y2:i,i:r,j:o,realIndex:l,groupIndex:b,series:n,barHeight:h,barWidth:d,barXPosition:c,barYPosition:g,visibleSeries:x,renderedPath:f}=t,L=this.w,p=new Graphics(this.barCtx.ctx),C=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[l]:this.barCtx.strokeWidth,u=a+parseFloat(d*x),w=e+parseFloat(h*x);L.globals.isXNumeric&&!L.globals.isBarHorizontal&&(u=a+parseFloat(d*(x+1)),w=e+parseFloat(h*(x+1))-C);let D=null,y=null,m=a,W=e,I={},v=L.config.dataLabels,k=this.barCtx.barOptions.dataLabels,H=this.barCtx.barOptions.dataLabels.total;void 0!==g&&this.barCtx.isRangeBar&&(w=g,W=g),void 0!==c&&this.barCtx.isVerticalGroupedRangeBar&&(u=c,m=c);const X=v.offsetX,A=v.offsetY;let B={width:0,height:0};if(L.config.dataLabels.enabled){const t=this.barCtx.series[r][o];B=p.getTextRects(L.globals.yLabelFormatters[0](t),parseFloat(v.style.fontSize))}const T={x:a,y:e,i:r,j:o,realIndex:l,groupIndex:b||-1,renderedPath:f,bcx:u,bcy:w,barHeight:h,barWidth:d,textRects:B,strokeWidth:C,dataLabelsX:m,dataLabelsY:W,dataLabelsConfig:v,barDataLabelsConfig:k,barTotalDataLabelsConfig:H,offX:X,offY:A};return I=this.barCtx.isHorizontal?this.calculateBarsDataLabelsPosition(T):this.calculateColumnsDataLabelsPosition(T),f.attr({cy:I.bcy,cx:I.bcx,j:o,val:n[r][o],barHeight:h,barWidth:d}),D=this.drawCalculatedDataLabels({x:I.dataLabelsX,y:I.dataLabelsY,val:this.barCtx.isRangeBar?[s,i]:n[r][o],i:l,j:o,barWidth:d,barHeight:h,textRects:B,dataLabelsConfig:v}),L.config.chart.stacked&&H.enabled&&(y=this.drawTotalDataLabels({x:I.totalDataLabelsX,y:I.totalDataLabelsY,barWidth:d,barHeight:h,realIndex:l,textAnchor:I.totalDataLabelsAnchor,val:this.getStackedTotalDataLabel({realIndex:l,j:o}),dataLabelsConfig:v,barTotalDataLabelsConfig:H})),{dataLabels:D,totalDataLabels:y}}getStackedTotalDataLabel({realIndex:t,j:a}){const e=this.w;let s=this.barCtx.stackedSeriesTotals[a];return this.totalFormatter&&(s=this.totalFormatter(s,{...e,seriesIndex:t,dataPointIndex:a,w:e})),s}calculateColumnsDataLabelsPosition(t){const a=this.w;let e,s,{i:i,j:r,realIndex:o,groupIndex:l,y:b,bcx:n,barWidth:h,barHeight:d,textRects:c,dataLabelsX:g,dataLabelsY:x,dataLabelsConfig:f,barDataLabelsConfig:L,barTotalDataLabelsConfig:p,strokeWidth:C,offX:u,offY:w}=t;d=Math.abs(d);let D="vertical"===a.config.plotOptions.bar.dataLabels.orientation;const{zeroEncounters:y}=this.barCtx.barHelpers.getZeroValueEncounters({i:i,j:r});n=n-C/2+(-1!==l?l*h:0);let m=a.globals.gridWidth/a.globals.dataPoints;if(this.barCtx.isVerticalGroupedRangeBar?g+=h/2:(g=a.globals.isXNumeric?n-h/2+u:n-m+h/2+u,y>0&&a.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(g-=h*y)),D){const t=2;g=g+c.height/2-C/2-t}let W=this.barCtx.series[i][r]<0,I=b;switch(this.barCtx.isReversed&&(I=b-d+(W?2*d:0),b-=d),L.position){case"center":x=D?W?I-d/2+w:I+d/2-w:W?I-d/2+c.height/2+w:I+d/2+c.height/2-w;break;case"bottom":x=D?W?I-d+w:I+d-w:W?I-d+c.height+C+w:I+d-c.height/2+C-w;break;case"top":x=D?W?I+w:I-w:W?I-c.height/2-w:I+c.height+w}if(this.barCtx.lastActiveBarSerieIndex===o&&p.enabled){const t=18,a=new Graphics(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:o,j:r}),f.fontSize);e=W?I-a.height/2-w-p.offsetY+t:I+a.height+w+p.offsetY-t,s=g+p.offsetX}return a.config.chart.stacked||(x<0?x=0+C:x+c.height/3>a.globals.gridHeight&&(x=a.globals.gridHeight-C)),{bcx:n,bcy:b,dataLabelsX:g,dataLabelsY:x,totalDataLabelsX:s,totalDataLabelsY:e,totalDataLabelsAnchor:"middle"}}calculateBarsDataLabelsPosition(t){const a=this.w;let{x:e,i:s,j:i,realIndex:r,groupIndex:o,bcy:l,barHeight:b,barWidth:n,textRects:h,dataLabelsX:d,strokeWidth:c,dataLabelsConfig:g,barDataLabelsConfig:x,barTotalDataLabelsConfig:f,offX:L,offY:p}=t,C=a.globals.gridHeight/a.globals.dataPoints;n=Math.abs(n),l+=-1!==o?o*b:0;let u,w,D=l-(this.barCtx.isRangeBar?0:C)+b/2+h.height/2+p-3,y="start",m=this.barCtx.series[s][i]<0,W=e;switch(this.barCtx.isReversed&&(W=e+n-(m?2*n:0),e=a.globals.gridWidth-n),x.position){case"center":d=m?W+n/2-L:Math.max(h.width/2,W-n/2)+L;break;case"bottom":d=m?W+n-c-Math.round(h.width/2)-L:W-n+c+Math.round(h.width/2)+L;break;case"top":d=m?W-c+Math.round(h.width/2)-L:W-c-Math.round(h.width/2)+L}if(this.barCtx.lastActiveBarSerieIndex===r&&f.enabled){const t=15,a=new Graphics(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:r,j:i}),g.fontSize);m?(u=W-c+Math.round(a.width/2)-L-f.offsetX-t,y="end"):u=W-c-Math.round(a.width/2)+L+f.offsetX+t,w=D+f.offsetY}return a.config.chart.stacked||(d<0?d=d+h.width+c:d+h.width/2>a.globals.gridWidth&&(d=a.globals.gridWidth-h.width-c)),{bcx:e,bcy:l,dataLabelsX:d,dataLabelsY:D,totalDataLabelsX:u,totalDataLabelsY:w,totalDataLabelsAnchor:y}}drawCalculatedDataLabels({x:t,y:a,val:e,i:s,j:i,textRects:r,barHeight:o,barWidth:l,dataLabelsConfig:b}){const n=this.w;let h="rotate(0)";"vertical"===n.config.plotOptions.bar.dataLabels.orientation&&(h=`rotate(-90, ${t}, ${a})`);const d=new DataLabels(this.barCtx.ctx),c=new Graphics(this.barCtx.ctx),g=b.formatter;let x=null;const f=n.globals.collapsedSeriesIndices.indexOf(s)>-1;if(b.enabled&&!f){x=c.group({class:"apexcharts-data-labels",transform:h});let f="";void 0!==e&&(f=g(e,{...n,seriesIndex:s,dataPointIndex:i,w:n})),!e&&n.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(f="");let L=n.globals.series[s][i]<0,p=n.config.plotOptions.bar.dataLabels.position;if("vertical"===n.config.plotOptions.bar.dataLabels.orientation&&("top"===p&&(b.textAnchor=L?"end":"start"),"center"===p&&(b.textAnchor="middle"),"bottom"===p&&(b.textAnchor=L?"end":"start")),this.barCtx.isRangeBar&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels){l<c.getTextRects(f,parseFloat(b.style.fontSize)).width&&(f="")}n.config.chart.stacked&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&(this.barCtx.isHorizontal?r.width/1.6>Math.abs(l)&&(f=""):r.height/1.6>Math.abs(o)&&(f=""));let C={...b};this.barCtx.isHorizontal&&e<0&&("start"===b.textAnchor?C.textAnchor="end":"end"===b.textAnchor&&(C.textAnchor="start")),d.plotDataLabelsText({x:t,y:a,text:f,i:s,j:i,parent:x,dataLabelsConfig:C,alwaysDrawDataLabel:!0,offsetCorrection:!0})}return x}drawTotalDataLabels({x:t,y:a,val:e,barWidth:s,barHeight:i,realIndex:r,textAnchor:o,barTotalDataLabelsConfig:l}){const b=this.w,n=new Graphics(this.barCtx.ctx);let h;return l.enabled&&void 0!==t&&void 0!==a&&this.barCtx.lastActiveBarSerieIndex===r&&(h=n.drawText({x:t-(!b.globals.isBarHorizontal&&b.globals.seriesGroups.length?s/b.globals.seriesGroups.length:0),y:a-(b.globals.isBarHorizontal&&b.globals.seriesGroups.length?i/b.globals.seriesGroups.length:0),foreColor:l.style.color,text:e,textAnchor:o,fontFamily:l.style.fontFamily,fontSize:l.style.fontSize,fontWeight:l.style.fontWeight})),h}}
//# sourceMappingURL=/sm/badf10e17705af8ea0fbdf4bb97d33c16b28fb45fe5cdb7d91d60667dc17eac0.map