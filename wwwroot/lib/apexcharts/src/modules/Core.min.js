/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/apexcharts@3.45.2/src/modules/Core.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Bar from"../charts/Bar";import BarStacked from"../charts/BarStacked";import BoxCandleStick from"../charts/BoxCandleStick";import CoreUtils from"./CoreUtils";import Crosshairs from"./Crosshairs";import HeatMap from"../charts/HeatMap";import Globals from"../modules/settings/Globals";import Pie from"../charts/Pie";import Radar from"../charts/Radar";import Radial from"../charts/Radial";import RangeBar from"../charts/RangeBar";import Legend from"./legend/Legend";import Line from"../charts/Line";import Treemap from"../charts/Treemap";import Graphics from"./Graphics";import Range from"./Range";import Utils from"../utils/Utils";import Scales from"./Scales";import TimeScale from"./TimeScale";export default class Core{constructor(e,t){this.ctx=t,this.w=t.w,this.el=e}setupElements(){let e=this.w.globals,t=this.w.config,s=t.chart.type;e.axisCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble","radar","heatmap","treemap"].indexOf(s)>-1,e.xyCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble"].indexOf(s)>-1,e.isBarHorizontal=("bar"===t.chart.type||"rangeBar"===t.chart.type||"boxPlot"===t.chart.type)&&t.plotOptions.bar.horizontal,e.chartClass=".apexcharts"+e.chartID,e.dom.baseEl=this.el,e.dom.elWrap=document.createElement("div"),Graphics.setAttrs(e.dom.elWrap,{id:e.chartClass.substring(1),class:"apexcharts-canvas "+e.chartClass.substring(1)}),this.el.appendChild(e.dom.elWrap),e.dom.Paper=new window.SVG.Doc(e.dom.elWrap),e.dom.Paper.attr({class:"apexcharts-svg","xmlns:data":"ApexChartsNS",transform:`translate(${t.chart.offsetX}, ${t.chart.offsetY})`}),e.dom.Paper.node.style.background="dark"!==t.theme.mode||t.chart.background?t.chart.background:"rgba(0, 0, 0, 0.8)",this.setSVGDimensions(),e.dom.elLegendForeign=document.createElementNS(e.SVGNS,"foreignObject"),Graphics.setAttrs(e.dom.elLegendForeign,{x:0,y:0,width:e.svgWidth,height:e.svgHeight}),e.dom.elLegendWrap=document.createElement("div"),e.dom.elLegendWrap.classList.add("apexcharts-legend"),e.dom.elLegendWrap.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),e.dom.elLegendForeign.appendChild(e.dom.elLegendWrap),e.dom.Paper.node.appendChild(e.dom.elLegendForeign),e.dom.elGraphical=e.dom.Paper.group().attr({class:"apexcharts-inner apexcharts-graphical"}),e.dom.elDefs=e.dom.Paper.defs(),e.dom.Paper.add(e.dom.elGraphical),e.dom.elGraphical.add(e.dom.elDefs)}plotChartType(e,t){const s=this.w,a=s.config,i=s.globals;let r={series:[],i:[]},o={series:[],i:[]},n={series:[],i:[]},l={series:[],i:[]},h={series:[],i:[]},c={series:[],i:[]},d={series:[],i:[]},g={series:[],i:[]},p={series:[],seriesRangeEnd:[],i:[]};i.series.map(((t,m)=>{let x=0;void 0!==e[m].type?("column"===e[m].type||"bar"===e[m].type?(i.series.length>1&&a.plotOptions.bar.horizontal&&console.warn("Horizontal bars are not supported in a mixed/combo chart. Please turn off `plotOptions.bar.horizontal`"),h.series.push(t),h.i.push(m),x++,s.globals.columnSeries=h.series):"area"===e[m].type?(o.series.push(t),o.i.push(m),x++):"line"===e[m].type?(r.series.push(t),r.i.push(m),x++):"scatter"===e[m].type?(n.series.push(t),n.i.push(m)):"bubble"===e[m].type?(l.series.push(t),l.i.push(m),x++):"candlestick"===e[m].type?(c.series.push(t),c.i.push(m),x++):"boxPlot"===e[m].type?(d.series.push(t),d.i.push(m),x++):"rangeBar"===e[m].type?(g.series.push(t),g.i.push(m),x++):"rangeArea"===e[m].type?(p.series.push(i.seriesRangeStart[m]),p.seriesRangeEnd.push(i.seriesRangeEnd[m]),p.i.push(m),x++):console.warn("You have specified an unrecognized chart type. Available types for this property are line/area/column/bar/scatter/bubble/candlestick/boxPlot/rangeBar/rangeArea"),x>1&&(i.comboCharts=!0)):(r.series.push(t),r.i.push(m))}));let m=new Line(this.ctx,t),x=new BoxCandleStick(this.ctx,t);this.ctx.pie=new Pie(this.ctx);let b=new Radial(this.ctx);this.ctx.rangeBar=new RangeBar(this.ctx,t);let f=new Radar(this.ctx),u=[];if(i.comboCharts){if(o.series.length>0&&u.push(m.draw(o.series,"area",o.i)),h.series.length>0)if(s.config.chart.stacked){let e=new BarStacked(this.ctx,t);u.push(e.draw(h.series,h.i))}else this.ctx.bar=new Bar(this.ctx,t),u.push(this.ctx.bar.draw(h.series,h.i));if(p.series.length>0&&u.push(m.draw(p.series,"rangeArea",p.i,p.seriesRangeEnd)),r.series.length>0&&u.push(m.draw(r.series,"line",r.i)),c.series.length>0&&u.push(x.draw(c.series,"candlestick",c.i)),d.series.length>0&&u.push(x.draw(d.series,"boxPlot",d.i)),g.series.length>0&&u.push(this.ctx.rangeBar.draw(g.series,g.i)),n.series.length>0){const e=new Line(this.ctx,t,!0);u.push(e.draw(n.series,"scatter",n.i))}if(l.series.length>0){const e=new Line(this.ctx,t,!0);u.push(e.draw(l.series,"bubble",l.i))}}else switch(a.chart.type){case"line":u=m.draw(i.series,"line");break;case"area":u=m.draw(i.series,"area");break;case"bar":if(a.chart.stacked){u=new BarStacked(this.ctx,t).draw(i.series)}else this.ctx.bar=new Bar(this.ctx,t),u=this.ctx.bar.draw(i.series);break;case"candlestick":u=new BoxCandleStick(this.ctx,t).draw(i.series,"candlestick");break;case"boxPlot":u=new BoxCandleStick(this.ctx,t).draw(i.series,a.chart.type);break;case"rangeBar":u=this.ctx.rangeBar.draw(i.series);break;case"rangeArea":u=m.draw(i.seriesRangeStart,"rangeArea",void 0,i.seriesRangeEnd);break;case"heatmap":u=new HeatMap(this.ctx,t).draw(i.series);break;case"treemap":u=new Treemap(this.ctx,t).draw(i.series);break;case"pie":case"donut":case"polarArea":u=this.ctx.pie.draw(i.series);break;case"radialBar":u=b.draw(i.series);break;case"radar":u=f.draw(i.series);break;default:u=m.draw(i.series)}return u}setSVGDimensions(){let e=this.w.globals,t=this.w.config;e.svgWidth=t.chart.width,e.svgHeight=t.chart.height;let s=Utils.getDimensions(this.el),a=t.chart.width.toString().split(/[0-9]+/g).pop();"%"===a?Utils.isNumber(s[0])&&(0===s[0].width&&(s=Utils.getDimensions(this.el.parentNode)),e.svgWidth=s[0]*parseInt(t.chart.width,10)/100):"px"!==a&&""!==a||(e.svgWidth=parseInt(t.chart.width,10));let i=t.chart.height.toString().split(/[0-9]+/g).pop();if("auto"!==e.svgHeight&&""!==e.svgHeight)if("%"===i){let s=Utils.getDimensions(this.el.parentNode);e.svgHeight=s[1]*parseInt(t.chart.height,10)/100}else e.svgHeight=parseInt(t.chart.height,10);else e.axisCharts?e.svgHeight=e.svgWidth/1.61:e.svgHeight=e.svgWidth/1.2;if(e.svgWidth<0&&(e.svgWidth=0),e.svgHeight<0&&(e.svgHeight=0),Graphics.setAttrs(e.dom.Paper.node,{width:e.svgWidth,height:e.svgHeight}),"%"!==i){let s=t.chart.sparkline.enabled?0:e.axisCharts?t.chart.parentHeightOffset:0;e.dom.Paper.node.parentNode.parentNode.style.minHeight=e.svgHeight+s+"px"}e.dom.elWrap.style.width=e.svgWidth+"px",e.dom.elWrap.style.height=e.svgHeight+"px"}shiftGraphPosition(){let e=this.w.globals,t=e.translateY,s={transform:"translate("+e.translateX+", "+t+")"};Graphics.setAttrs(e.dom.elGraphical.node,s)}resizeNonAxisCharts(){const e=this.w,t=e.globals;let s=0,a=e.config.chart.sparkline.enabled?1:15;a+=e.config.grid.padding.bottom,"top"!==e.config.legend.position&&"bottom"!==e.config.legend.position||!e.config.legend.show||e.config.legend.floating||(s=new Legend(this.ctx).legendHelpers.getLegendBBox().clwh+10);let i=e.globals.dom.baseEl.querySelector(".apexcharts-radialbar, .apexcharts-pie"),r=2.05*e.globals.radialSize;if(i&&!e.config.chart.sparkline.enabled&&0!==e.config.plotOptions.radialBar.startAngle){let t=Utils.getBoundingClientRect(i);r=t.bottom;let s=t.bottom-t.top;r=Math.max(2.05*e.globals.radialSize,s)}let o=r+t.translateY+s+a;t.dom.elLegendForeign&&t.dom.elLegendForeign.setAttribute("height",o),e.config.chart.height&&String(e.config.chart.height).indexOf("%")>0||(t.dom.elWrap.style.height=o+"px",Graphics.setAttrs(t.dom.Paper.node,{height:o}),t.dom.Paper.node.parentNode.parentNode.style.minHeight=o+"px")}coreCalculations(){new Range(this.ctx).init()}resetGlobals(){const e=()=>this.w.config.series.map((e=>[])),t=new Globals;let s=this.w.globals;t.initGlobalVars(s),s.seriesXvalues=e(),s.seriesYvalues=e()}isMultipleY(){if(this.w.config.yaxis.constructor===Array&&this.w.config.yaxis.length>1)return this.w.globals.isMultipleYAxis=!0,!0}xySettings(){let e=null;const t=this.w;if(t.globals.axisCharts){if("back"===t.config.xaxis.crosshairs.position){new Crosshairs(this.ctx).drawXCrosshairs()}if("back"===t.config.yaxis[0].crosshairs.position){new Crosshairs(this.ctx).drawYCrosshairs()}if("datetime"===t.config.xaxis.type&&void 0===t.config.xaxis.labels.formatter){this.ctx.timeScale=new TimeScale(this.ctx);let e=[];isFinite(t.globals.minX)&&isFinite(t.globals.maxX)&&!t.globals.isBarHorizontal?e=this.ctx.timeScale.calculateTimeScaleTicks(t.globals.minX,t.globals.maxX):t.globals.isBarHorizontal&&(e=this.ctx.timeScale.calculateTimeScaleTicks(t.globals.minY,t.globals.maxY)),this.ctx.timeScale.recalcDimensionsBasedOnFormat(e)}e=new CoreUtils(this.ctx).getCalculatedRatios()}return e}updateSourceChart(e){this.ctx.w.globals.selection=void 0,this.ctx.updateHelpers._updateOptions({chart:{selection:{xaxis:{min:e.w.globals.minX,max:e.w.globals.maxX}}}},!1,!1)}setupBrushHandler(){const e=this.w;if(e.config.chart.brush.enabled&&"function"!=typeof e.config.chart.events.selection){let t=Array.isArray(e.config.chart.brush.targets)?e.config.chart.brush.targets:[e.config.chart.brush.target];t.forEach((e=>{let t=ApexCharts.getChartByID(e);t.w.globals.brushSource=this.ctx,"function"!=typeof t.w.config.chart.events.zoomed&&(t.w.config.chart.events.zoomed=()=>{this.updateSourceChart(t)}),"function"!=typeof t.w.config.chart.events.scrolled&&(t.w.config.chart.events.scrolled=()=>{this.updateSourceChart(t)})})),e.config.chart.events.selection=(s,a)=>{t.forEach((t=>{let s=ApexCharts.getChartByID(t),i=Utils.clone(e.config.yaxis);if(e.config.chart.brush.autoScaleYaxis&&1===s.w.globals.series.length){const e=new Scales(s);i=e.autoScaleY(s,i,a)}const r=s.w.config.yaxis.reduce(((e,t,a)=>[...e,{...s.w.config.yaxis[a],min:i[0].min,max:i[0].max}]),[]);s.ctx.updateHelpers._updateOptions({xaxis:{min:a.xaxis.min,max:a.xaxis.max},yaxis:r},!1,!1,!1,!1)}))}}}}
//# sourceMappingURL=/sm/bca64d0f13cb91a83c498251bcd72adc646a7f2512819418103cfa68dc7d80a3.map