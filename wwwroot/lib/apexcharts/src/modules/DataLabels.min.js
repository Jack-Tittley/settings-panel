/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/apexcharts@3.45.2/src/modules/DataLabels.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Scatter from"./../charts/Scatter";import Graphics from"./Graphics";import Filters from"./Filters";class DataLabels{constructor(t){this.ctx=t,this.w=t.w}dataLabelsCorrection(t,a,e,s,l,r,o){let i=this.w,n=!1,d=new Graphics(this.ctx).getTextRects(e,o),c=d.width,b=d.height;a<0&&(a=0),a>i.globals.gridHeight+b&&(a=i.globals.gridHeight+b/2),void 0===i.globals.dataLabelsRects[s]&&(i.globals.dataLabelsRects[s]=[]),i.globals.dataLabelsRects[s].push({x:t,y:a,width:c,height:b});let g=i.globals.dataLabelsRects[s].length-2,h=void 0!==i.globals.lastDrawnDataLabelsIndexes[s]?i.globals.lastDrawnDataLabelsIndexes[s][i.globals.lastDrawnDataLabelsIndexes[s].length-1]:0;if(void 0!==i.globals.dataLabelsRects[s][g]){let e=i.globals.dataLabelsRects[s][h];(t>e.x+e.width||a>e.y+e.height||a+b<e.y||t+c<e.x)&&(n=!0)}return(0===l||r)&&(n=!0),{x:t,y:a,textRects:d,drawnextLabel:n}}drawDataLabel({type:t,pos:a,i:e,j:s,isRangeStart:l,strokeWidth:r=2}){let o=this.w;const i=new Graphics(this.ctx);let n=o.config.dataLabels,d=0,c=0,b=s,g=null;if(!n.enabled||!Array.isArray(a.x))return g;g=i.group({class:"apexcharts-data-labels"});for(let i=0;i<a.x.length;i++)if(d=a.x[i]+n.offsetX,c=a.y[i]+n.offsetY+r,!isNaN(d)){1===s&&0===i&&(b=0),1===s&&1===i&&(b=1);let r=o.globals.series[e][b];"rangeArea"===t&&(r=l?o.globals.seriesRangeStart[e][b]:o.globals.seriesRangeEnd[e][b]);let n="";const h=t=>o.config.dataLabels.formatter(t,{ctx:this.ctx,seriesIndex:e,dataPointIndex:b,w:o});if("bubble"===o.config.chart.type){r=o.globals.seriesZ[e][b],n=h(r),c=a.y[i];c=new Scatter(this.ctx).centerTextInBubble(c,e,b).y}else void 0!==r&&(n=h(r));this.plotDataLabelsText({x:d,y:c,text:n,i:e,j:b,parent:g,offsetCorrection:!0,dataLabelsConfig:o.config.dataLabels})}return g}plotDataLabelsText(t){let a=this.w,e=new Graphics(this.ctx),{x:s,y:l,i:r,j:o,text:i,textAnchor:n,fontSize:d,parent:c,dataLabelsConfig:b,color:g,alwaysDrawDataLabel:h,offsetCorrection:f}=t;if(Array.isArray(a.config.dataLabels.enabledOnSeries)&&a.config.dataLabels.enabledOnSeries.indexOf(r)<0)return;let x={x:s,y:l,drawnextLabel:!0,textRects:null};f&&(x=this.dataLabelsCorrection(s,l,i,r,o,h,parseInt(b.style.fontSize,10))),a.globals.zoomed||(s=x.x,l=x.y),x.textRects&&(s<-20-x.textRects.width||s>a.globals.gridWidth+x.textRects.width+30)&&(i="");let p=a.globals.dataLabels.style.colors[r];(("bar"===a.config.chart.type||"rangeBar"===a.config.chart.type)&&a.config.plotOptions.bar.distributed||a.config.dataLabels.distributed)&&(p=a.globals.dataLabels.style.colors[o]),"function"==typeof p&&(p=p({series:a.globals.series,seriesIndex:r,dataPointIndex:o,w:a})),g&&(p=g);let w=b.offsetX,y=b.offsetY;if("bar"!==a.config.chart.type&&"rangeBar"!==a.config.chart.type||(w=0,y=0),x.drawnextLabel){let t=e.drawText({width:100,height:parseInt(b.style.fontSize,10),x:s+w,y:l+y,foreColor:p,textAnchor:n||b.textAnchor,text:i,fontSize:d||b.style.fontSize,fontFamily:b.style.fontFamily,fontWeight:b.style.fontWeight||"normal"});if(t.attr({class:"apexcharts-datalabel",cx:s,cy:l}),b.dropShadow.enabled){const a=b.dropShadow;new Filters(this.ctx).dropShadow(t,a)}c.add(t),void 0===a.globals.lastDrawnDataLabelsIndexes[r]&&(a.globals.lastDrawnDataLabelsIndexes[r]=[]),a.globals.lastDrawnDataLabelsIndexes[r].push(o)}}addBackgroundToDataLabel(t,a){const e=this.w,s=e.config.dataLabels.background,l=s.padding,r=s.padding/2,o=a.width,i=a.height,n=new Graphics(this.ctx).drawRect(a.x-l,a.y-r/2,o+2*l,i+r,s.borderRadius,"transparent"===e.config.chart.background?"#fff":e.config.chart.background,s.opacity,s.borderWidth,s.borderColor);if(s.dropShadow.enabled){new Filters(this.ctx).dropShadow(n,s.dropShadow)}return n}dataLabelsBackground(){const t=this.w;if("bubble"===t.config.chart.type)return;const a=t.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels text");for(let e=0;e<a.length;e++){const s=a[e],l=s.getBBox();let r=null;if(l.width&&l.height&&(r=this.addBackgroundToDataLabel(s,l)),r){s.parentNode.insertBefore(r.node,s);const a=s.getAttribute("fill");t.config.chart.animations.enabled&&!t.globals.resized&&!t.globals.dataChanged?r.animate().attr({fill:a}):r.attr({fill:a}),s.setAttribute("fill",t.config.dataLabels.background.foreColor)}}}bringForward(){const t=this.w,a=t.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels"),e=t.globals.dom.baseEl.querySelector(".apexcharts-plot-series:last-child");for(let t=0;t<a.length;t++)e&&e.insertBefore(a[t],e.nextSibling)}}export default DataLabels;
//# sourceMappingURL=/sm/2df8cc9076caac8d3441c0667b78eb287e33d426bde1847e3cfcbc5f2a9051a0.map